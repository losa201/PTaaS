import{j as e}from"./radix-DxzCRVju.js";import{r as s}from"./vendor-DzRNnqOo.js";import{a,C as t,b as i,c as n,e as l,B as r,d as c}from"./badge-HxxDkgLF.js";import{I as d}from"./input-DuAosNtO.js";import{T as m,a as o,b as x,c as h}from"./tabs-D1QASTcw.js";import{S as u,a as j,b as p,c as g,d as v}from"./select-CVY5Arhg.js";import{A as f,a as N}from"./alert-B_hUaamt.js";import{T as y}from"./textarea-BkFZpVwL.js";import{m as b,n as w,o as S,p as A,d as T,i as C,T as D,B as I,a as k,D as q,b as E,P,q as M,E as H,e as L}from"./ui-BQ7LbOrQ.js";import"./utils-BjC949i_.js";import"./index-BSzldsLw.js";import"./query-DuTjhaK9.js";const z=()=>{const[z,B]=s.useState("active-hunts"),[F,R]=s.useState(""),[O,Q]=s.useState("all"),[W,V]=s.useState("manual"),[K,_]=s.useState([{id:"hunt-001",name:"APT Lateral Movement Detection",description:"Hunting for signs of lateral movement using WMI and PsExec",status:"running",priority:"high",technique:"T1021.002, T1021.003",dataSource:["Windows Events","Network Logs","Process Creation"],progress:67,findings:3,startTime:"2 hours ago",estimatedCompletion:"45 minutes",huntType:"behavioral"},{id:"hunt-002",name:"Suspicious PowerShell Activity",description:"Detecting obfuscated PowerShell commands and encoded payloads",status:"completed",priority:"medium",technique:"T1059.001",dataSource:["PowerShell Logs","Command Line Logs"],progress:100,findings:7,startTime:"6 hours ago",estimatedCompletion:"Completed",huntType:"hypothesis"},{id:"hunt-003",name:"Data Exfiltration Indicators",description:"Looking for unusual data transfer patterns and file compression",status:"paused",priority:"critical",technique:"T1041, T1560",dataSource:["Network Traffic","File System Events"],progress:23,findings:12,startTime:"1 day ago",estimatedCompletion:"2 hours",huntType:"anomaly"}]),[G,U]=s.useState([{id:"finding-001",huntId:"hunt-001",severity:"high",confidence:85,title:"Suspicious WMI Process Creation",description:"Multiple WMI process creations detected from single source, indicating possible lateral movement",evidence:"wmiprvse.exe spawned 15 processes in 2 minutes from 192.168.1.50",timestamp:"30 minutes ago",affectedAssets:["DC01","WEB-SRV-02","DB-PROD-01"],mitreMapping:["T1021.002"],status:"investigating"},{id:"finding-002",huntId:"hunt-002",severity:"critical",confidence:92,title:"Base64 Encoded PowerShell Execution",description:"Highly obfuscated PowerShell command detected with base64 encoding and multiple layers",evidence:"powershell.exe -EncodedCommand SQBFAFgAKABOAGUAdwAtAE8AYgBqAGU...",timestamp:"4 hours ago",affectedAssets:["WORKSTATION-15"],mitreMapping:["T1059.001","T1140"],status:"validated"},{id:"finding-003",huntId:"hunt-003",severity:"medium",confidence:78,title:"Unusual File Compression Activity",description:"Large volume file compression detected during off-hours",evidence:"7zip.exe compressed 2.3GB of sensitive files at 3:47 AM",timestamp:"18 hours ago",affectedAssets:["FILE-SRV-01"],mitreMapping:["T1560.001"],status:"new"}]),[Y]=s.useState([{id:"query-001",name:"Suspicious Process Creation",query:'EventID=4688 AND (CommandLine CONTAINS "powershell" OR CommandLine CONTAINS "cmd")',dataSource:"Windows Security Events",category:"endpoint",description:"Detect suspicious process creation with command line analysis"},{id:"query-002",name:"Failed Authentication Patterns",query:"EventID=4625 AND LogonType=3 AND SubStatus=0xC000006A",dataSource:"Authentication Logs",category:"user",description:"Multiple failed authentication attempts indicating brute force"},{id:"query-003",name:"Network Beaconing Detection",query:"protocol=tcp AND bytes_out>1024 AND connection_duration>300",dataSource:"Network Flow Logs",category:"network",description:"Detect periodic network connections that may indicate C2 beaconing"}]),$=e=>{switch(e){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},J=e=>{switch(e){case"running":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"paused":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return s.useEffect(()=>{const e=setInterval(()=>{_(e=>e.map(e=>{if("running"===e.status&&e.progress<100){const s=Math.min(100,e.progress+5*Math.random()),a=e.findings+(Math.random()>.8?1:0);return{...e,progress:s,findings:a}}return e}))},3e3);return()=>clearInterval(e)},[]),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"Advanced Threat Hunting"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl",children:"Proactive threat hunting with AI-powered analytics, behavioral detection, and automated investigation workflows to uncover hidden threats."})]}),e.jsx("div",{className:"bg-white rounded-lg border p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(d,{placeholder:"Search hunts, findings, or techniques...",value:F,onChange:e=>R(e.target.value),className:"pl-10"})]}),e.jsxs(u,{value:O,onValueChange:Q,children:[e.jsxs(j,{className:"w-[150px]",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),e.jsx(p,{placeholder:"Severity"})]}),e.jsxs(g,{children:[e.jsx(v,{value:"all",children:"All Severity"}),e.jsx(v,{value:"critical",children:"Critical"}),e.jsx(v,{value:"high",children:"High"}),e.jsx(v,{value:"medium",children:"Medium"}),e.jsx(v,{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(a,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Export Results"]}),e.jsxs(a,{size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"New Hunt"]})]})]})}),e.jsxs(m,{value:z,onValueChange:B,className:"space-y-6",children:[e.jsxs(o,{className:"grid w-full grid-cols-5",children:[e.jsxs(x,{value:"active-hunts",className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Active Hunts"]}),e.jsxs(x,{value:"findings",className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Findings"]}),e.jsxs(x,{value:"hunt-builder",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Hunt Builder"]}),e.jsxs(x,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Analytics"]}),e.jsxs(x,{value:"queries",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Saved Queries"]})]}),e.jsx(h,{value:"active-hunts",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6",children:K.map((s,d)=>e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*d},children:e.jsxs(t,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-xl mb-2",children:s.name}),e.jsx(l,{className:"text-sm mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),"Started ",s.startTime]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-4 w-4"}),s.technique]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:$(s.priority),children:s.priority}),e.jsx(r,{className:J(s.status),children:s.status})]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Progress"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(b.div,{className:"bg-blue-600 h-2 rounded-full",initial:{width:0},animate:{width:`${s.progress}%`},transition:{duration:.5}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Est. completion: ",s.estimatedCompletion]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Data Sources"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.dataSource.map((s,a)=>e.jsx(r,{variant:"outline",className:"text-xs",children:s},a))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.findings}),e.jsx("p",{className:"text-xs text-gray-600",children:"Findings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.huntType}),e.jsx("p",{className:"text-xs text-gray-600",children:"Hunt Type"})]})]}),e.jsxs("div",{className:"flex gap-2",children:["running"===s.status?e.jsxs(a,{size:"sm",variant:"outline",onClick:()=>{return e=s.id,void _(s=>s.map(s=>s.id===e?{...s,status:"paused"}:s));var e},children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Pause"]}):e.jsxs(a,{size:"sm",variant:"outline",onClick:()=>{return e=s.id,void _(s=>s.map(s=>s.id===e?{...s,status:"running"}:s));var e},children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Resume"]}),e.jsxs(a,{size:"sm",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"View Details"]})]})]})]})})]})},s.id))})}),e.jsx(h,{value:"findings",className:"space-y-6",children:e.jsx("div",{className:"grid gap-4",children:G.map((s,i)=>e.jsx(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*i},children:e.jsx(t,{className:"hover:shadow-md transition-shadow",children:e.jsxs(c,{className:"pt-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsx(r,{className:$(s.severity),children:s.severity}),e.jsxs(r,{variant:"outline",children:["Confidence: ",s.confidence,"%"]})]}),e.jsx("p",{className:"text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Evidence:"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded font-mono text-sm",children:s.evidence})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.mitreMapping.map((s,a)=>e.jsx(r,{variant:"secondary",className:"text-xs",children:s},a))}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Affected Assets:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.affectedAssets.map((s,a)=>e.jsx(r,{variant:"outline",className:"text-xs",children:s},a))})]})]}),e.jsxs("div",{className:"ml-6 text-right",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:s.timestamp}),e.jsx(r,{className:"validated"===s.status?"bg-green-100 text-green-800":"investigating"===s.status?"bg-blue-100 text-blue-800":"false_positive"===s.status?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800",children:s.status.replace("_"," ")})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(a,{size:"sm",variant:"outline",children:"Investigate"}),e.jsx(a,{size:"sm",variant:"outline",children:"Mark as False Positive"}),e.jsx(a,{size:"sm",children:"Create Incident"})]})]})})},s.id))})}),e.jsx(h,{value:"hunt-builder",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"AI-Powered Hunt Builder"]}),e.jsx(l,{children:"Create custom threat hunts using natural language or advanced query builders"})]}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(a,{variant:"manual"===W?"default":"outline",onClick:()=>V("manual"),size:"sm",children:"Manual Query"}),e.jsx(a,{variant:"automated"===W?"default":"outline",onClick:()=>V("automated"),size:"sm",children:"AI Assistant"})]}),e.jsx(L,{mode:"wait",children:"automated"===W?e.jsxs(b.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Describe what you want to hunt for:"}),e.jsx(y,{placeholder:"e.g., Find signs of credential stuffing attacks against our web applications in the last 24 hours...",className:"min-h-[100px]"})]}),e.jsxs(f,{children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(N,{children:"AI will analyze your request and suggest appropriate data sources, queries, and MITRE ATT&CK techniques to hunt for."})]})]},"automated"):e.jsxs(b.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Hunt Name"}),e.jsx(d,{placeholder:"Enter hunt name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Description"}),e.jsx(y,{placeholder:"Describe your hunting hypothesis..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Priority"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Select priority"})}),e.jsxs(g,{children:[e.jsx(v,{value:"low",children:"Low"}),e.jsx(v,{value:"medium",children:"Medium"}),e.jsx(v,{value:"high",children:"High"}),e.jsx(v,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Hunt Type"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Select type"})}),e.jsxs(g,{children:[e.jsx(v,{value:"hypothesis",children:"Hypothesis-driven"}),e.jsx(v,{value:"ioc",children:"IOC-based"}),e.jsx(v,{value:"behavioral",children:"Behavioral"}),e.jsx(v,{value:"anomaly",children:"Anomaly Detection"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Query"}),e.jsx(y,{placeholder:"Enter your hunting query (KQL, SPL, or SQL)...",className:"min-h-[120px] font-mono"})]})]},"manual")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Start Hunt"]}),e.jsx(a,{variant:"outline",children:"Save Draft"}),e.jsx(a,{variant:"outline",children:"Validate Query"})]})]})]})}),e.jsxs(h,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(t,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Hunts"}),e.jsx("p",{className:"text-3xl font-bold",children:"12"})]}),e.jsx(C,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(t,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Findings"}),e.jsx("p",{className:"text-3xl font-bold",children:"247"})]}),e.jsx(D,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(t,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Success Rate"}),e.jsx("p",{className:"text-3xl font-bold",children:"87%"})]}),e.jsx(k,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(t,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Hunt Time"}),e.jsx("p",{className:"text-3xl font-bold",children:"4.2h"})]}),e.jsx(E,{className:"h-8 w-8 text-purple-600"})]})})})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(n,{children:"Hunt Performance Trends"}),e.jsx(l,{children:"Track the effectiveness of your threat hunting operations over time"})]}),e.jsx(c,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"ðŸ“Š Interactive charts showing hunt success rates, finding trends, and performance metrics"})})]})]}),e.jsx(h,{value:"queries",className:"space-y-6",children:e.jsx("div",{className:"grid gap-4",children:Y.map((s,i)=>e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*i},children:e.jsx(t,{className:"hover:shadow-md transition-shadow",children:e.jsxs(c,{className:"pt-6",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx(r,{variant:"outline",children:s.category})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:s.description}),e.jsx("div",{className:"bg-gray-100 p-3 rounded font-mono text-sm",children:s.query}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Data Source: ",s.dataSource]})]})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(a,{size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Run Query"]}),e.jsx(a,{size:"sm",variant:"outline",children:"Edit"}),e.jsx(a,{size:"sm",variant:"outline",children:"Create Hunt"})]})]})})},s.id))})})]})]})};export{z as default};
