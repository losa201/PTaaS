import{j as e}from"./radix-DxzCRVju.js";import{r as s}from"./vendor-DzRNnqOo.js";import{C as a,d as t,b as i,c as l,e as r,a as n,B as c}from"./badge-B4px3aw-.js";import{T as d,a as x,b as m,c as o}from"./tabs-3e3CP3NJ.js";import{S as h,a as u,b as j,c as p,d as g}from"./select-De6u1-U7.js";import{I as v}from"./input-BLyJMatu.js";import{L as N}from"./label-B0pm7tRO.js";import{T as y}from"./textarea-DgJkr5DR.js";import{P as f}from"./progress-Vgn8XOdd.js";import{m as w,s as b,G as S,ak as T,al as A,a8 as C,X as R,T as I,ag as P,d as L,i as k,q as E,j as z,l as D,P as q,E as O,o as W,aa as F,a3 as V,L as Z,c as U,Z as M,p as B,a4 as J,ab as Q,b as _,S as H,a9 as G,K as $}from"./ui-df0GovdX.js";import"./utils-BjC949i_.js";import"./index-BIt4v-LU.js";import"./query-DuTjhaK9.js";const K=()=>{const[K,X]=s.useState("dashboard");s.useState("all");const[Y,ee]=s.useState("all"),[se,ae]=s.useState(""),[te,ie]=s.useState(!1),[le]=s.useState([{id:"api-001",name:"User Authentication",url:"/api/v1/auth/login",method:"POST",description:"User login endpoint with JWT token generation",authRequired:!1,riskScore:85,lastTested:"2025-08-08T14:30:00Z",vulnerabilities:{critical:1,high:2,medium:3,low:1},status:"active",version:"v1.2.3",owner:"Authentication Service"},{id:"api-002",name:"User Profile",url:"/api/v1/users/{id}",method:"GET",description:"Retrieve user profile information",authRequired:!0,riskScore:65,lastTested:"2025-08-08T15:45:00Z",vulnerabilities:{critical:0,high:1,medium:2,low:4},status:"active",version:"v1.2.3",owner:"User Service"},{id:"api-003",name:"Payment Processing",url:"/api/v1/payments",method:"POST",description:"Process payment transactions",authRequired:!0,riskScore:95,lastTested:"2025-08-08T12:20:00Z",vulnerabilities:{critical:2,high:1,medium:1,low:0},status:"active",version:"v2.1.0",owner:"Payment Service"},{id:"api-004",name:"File Upload",url:"/api/v1/files/upload",method:"POST",description:"Upload files to cloud storage",authRequired:!0,riskScore:78,lastTested:"2025-08-07T09:30:00Z",vulnerabilities:{critical:0,high:3,medium:2,low:2},status:"active",version:"v1.5.2",owner:"File Service"}]),[re]=s.useState([{id:"test-001",name:"SQL Injection Test",description:"Test for SQL injection vulnerabilities in API parameters",category:"injection",severity:"critical",technique:"Automated payload injection",payload:"'; DROP TABLE users; --",expectedResult:"Should return error without exposing database structure",automated:!0,owaspCategory:"A03:2021 – Injection"},{id:"test-002",name:"Authentication Bypass",description:"Attempt to bypass authentication mechanisms",category:"authentication",severity:"critical",technique:"JWT token manipulation",expectedResult:"Should reject invalid or manipulated tokens",automated:!0,owaspCategory:"A07:2021 – Identification and Authentication Failures"},{id:"test-003",name:"Rate Limiting Validation",description:"Verify rate limiting controls are properly implemented",category:"rate_limiting",severity:"medium",technique:"Automated request flooding",expectedResult:"Should throttle requests after threshold",automated:!0,owaspCategory:"A04:2021 – Insecure Design"},{id:"test-004",name:"Privilege Escalation",description:"Test for vertical and horizontal privilege escalation",category:"authorization",severity:"high",technique:"Parameter manipulation",expectedResult:"Should maintain proper access controls",automated:!0,owaspCategory:"A01:2021 – Broken Access Control"}]),[ne]=s.useState([{id:"suite-001",name:"Authentication & Authorization Suite",description:"Comprehensive testing of authentication and authorization mechanisms",endpoints:["api-001","api-002"],tests:["test-001","test-002","test-004"],schedule:"daily",lastRun:"2025-08-08T16:00:00Z",status:"failing",passRate:78.5,totalTests:47,duration:45},{id:"suite-002",name:"Payment Security Suite",description:"Specialized testing for payment processing endpoints",endpoints:["api-003"],tests:["test-001","test-002","test-003","test-004"],schedule:"daily",lastRun:"2025-08-08T14:30:00Z",status:"failing",passRate:65.2,totalTests:23,duration:32},{id:"suite-003",name:"File Upload Security Suite",description:"Security testing for file upload and processing endpoints",endpoints:["api-004"],tests:["test-001","test-003"],schedule:"weekly",lastRun:"2025-08-07T10:00:00Z",status:"warning",passRate:82.6,totalTests:15,duration:18}]),[ce]=s.useState([{id:"vuln-001",endpointId:"api-001",testId:"test-001",title:"SQL Injection in Login Parameter",description:"Username parameter vulnerable to SQL injection allowing database access",severity:"critical",category:"Injection",cweId:"CWE-89",owaspCategory:"A03:2021 – Injection",discoveredDate:"2025-08-08T14:30:00Z",status:"open",evidence:"SELECT * FROM users WHERE username = '' OR 1=1 --' AND password = ''",remediation:"Implement parameterized queries and input validation",cvssScore:9.1},{id:"vuln-002",endpointId:"api-003",testId:"test-002",title:"JWT Token Manipulation",description:"JWT tokens can be manipulated to escalate privileges",severity:"high",category:"Authentication",cweId:"CWE-287",owaspCategory:"A07:2021 – Identification and Authentication Failures",discoveredDate:"2025-08-08T12:20:00Z",status:"acknowledged",evidence:'Modified JWT payload to change user role from "user" to "admin"',remediation:"Implement proper JWT signature verification and role validation",cvssScore:7.5},{id:"vuln-003",endpointId:"api-004",testId:"test-003",title:"Insufficient Rate Limiting",description:"File upload endpoint lacks proper rate limiting controls",severity:"medium",category:"Rate Limiting",cweId:"CWE-770",owaspCategory:"A04:2021 – Insecure Design",discoveredDate:"2025-08-07T09:30:00Z",status:"fixed",evidence:"Successfully uploaded 1000 files in 60 seconds without throttling",remediation:"Implement rate limiting based on user/IP with exponential backoff",cvssScore:5.3}]),[de]=s.useState([{id:"exec-001",suiteId:"suite-001",suiteName:"Authentication & Authorization Suite",status:"running",startTime:"2025-08-09T16:30:00Z",progress:68,testsRun:32,totalTests:47,passed:25,failed:4,warnings:3,duration:28,findings:7},{id:"exec-002",suiteId:"suite-002",suiteName:"Payment Security Suite",status:"completed",startTime:"2025-08-09T14:30:00Z",endTime:"2025-08-09T15:02:00Z",progress:100,testsRun:23,totalTests:23,passed:15,failed:6,warnings:2,duration:32,findings:8}]),xe=e=>{switch(e){case"critical":return"text-red-600 bg-red-100 border-red-200";case"high":return"text-orange-600 bg-orange-100 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"low":return"text-green-600 bg-green-100 border-green-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},me=e=>{switch(e){case"passing":case"completed":case"fixed":return"bg-green-100 text-green-800";case"failing":case"failed":case"open":return"bg-red-100 text-red-800";case"warning":case"acknowledged":return"bg-yellow-100 text-yellow-800";case"not_run":case"cancelled":case"false_positive":default:return"bg-gray-100 text-gray-800";case"running":return"bg-blue-100 text-blue-800"}},oe=e=>{switch(e){case"GET":return"bg-blue-100 text-blue-800";case"POST":return"bg-green-100 text-green-800";case"PUT":return"bg-orange-100 text-orange-800";case"DELETE":return"bg-red-100 text-red-800";case"PATCH":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},he=s=>{switch(s){case"authentication":return e.jsx(Z,{className:"h-4 w-4"});case"authorization":return e.jsx($,{className:"h-4 w-4"});case"injection":return e.jsx(A,{className:"h-4 w-4"});case"data_exposure":return e.jsx(O,{className:"h-4 w-4"});case"rate_limiting":return e.jsx(G,{className:"h-4 w-4"});case"input_validation":return e.jsx(H,{className:"h-4 w-4"});default:return e.jsx(L,{className:"h-4 w-4"})}},ue=e=>e>=80?"text-red-600":e>=60?"text-orange-600":e>=40?"text-yellow-600":"text-green-600",je=async e=>{ie(!0),setTimeout(()=>{ie(!1)},5e3)},pe=le.length;ce.length;const ge=ce.filter(e=>"critical"===e.severity).length,ve=Math.round(le.reduce((e,s)=>e+s.riskScore,0)/le.length),Ne=ce.filter(e=>"open"===e.status).length,ye=le.filter(e=>""===se||e.name.toLowerCase().includes(se.toLowerCase())||e.url.toLowerCase().includes(se.toLowerCase())),fe=ce.filter(e=>{const s="all"===Y||e.severity===Y,a=""===se||e.title.toLowerCase().includes(se.toLowerCase())||e.description.toLowerCase().includes(se.toLowerCase());return s&&a});return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"API Security Testing Platform"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl",children:"Comprehensive API security testing with automated vulnerability discovery, OWASP Top 10 coverage, and continuous security monitoring for REST and GraphQL APIs."})]}),e.jsxs(d,{value:K,onValueChange:X,className:"space-y-6",children:[e.jsxs(x,{className:"grid w-full grid-cols-6",children:[e.jsxs(m,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Dashboard"]}),e.jsxs(m,{value:"endpoints",className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"Endpoints"]}),e.jsxs(m,{value:"test-suites",className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Test Suites"]}),e.jsxs(m,{value:"vulnerabilities",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Vulnerabilities"]}),e.jsxs(m,{value:"tests",className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Security Tests"]}),e.jsxs(m,{value:"scanner",className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Scanner"]})]}),e.jsxs(o,{value:"dashboard",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(a,{children:e.jsxs(t,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"API Endpoints"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:pe})]}),e.jsx(S,{className:"h-8 w-8 text-blue-600"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Under security testing"})]})}),e.jsx(a,{children:e.jsxs(t,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critical Vulnerabilities"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:ge})]}),e.jsx(I,{className:"h-8 w-8 text-red-600"})]}),e.jsxs("p",{className:"text-xs text-red-600 mt-2",children:[Ne," open findings"]})]})}),e.jsx(a,{children:e.jsxs(t,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Risk Score"}),e.jsx("p",{className:`text-3xl font-bold ${ue(ve)}`,children:ve})]}),e.jsx(P,{className:"h-8 w-8 text-orange-600"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Across all endpoints"})]})}),e.jsx(a,{children:e.jsxs(t,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Test Coverage"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:"87%"})]}),e.jsx(L,{className:"h-8 w-8 text-green-600"})]}),e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"OWASP Top 10 coverage"})]})})]}),e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Active Test Executions"]}),e.jsx(r,{children:"Currently running API security test suites"})]}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[de.filter(e=>"running"===e.status).map((s,a)=>e.jsxs(w.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*a},className:"flex items-center justify-between p-4 border rounded-lg bg-blue-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:e.jsx(E,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.suiteName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Test ",s.testsRun," of ",s.totalTests]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Running for ",s.duration," minutes"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(z,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:[s.passed," passed"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(D,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{children:[s.failed," failed"]})]})]}),e.jsx("div",{className:"w-32",children:e.jsx(f,{value:s.progress})}),e.jsxs("span",{className:"text-sm font-medium",children:[s.progress,"%"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{size:"sm",variant:"outline",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(n,{size:"sm",variant:"outline",children:e.jsx(O,{className:"h-4 w-4"})})]})]})]},s.id)),0===de.filter(e=>"running"===e.status).length&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(R,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"No active test executions"})]})]})})]}),e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Recent Security Findings"]}),e.jsx(r,{children:"Latest vulnerabilities discovered in API endpoints"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:ce.slice(0,5).map((s,a)=>e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-full ${xe(s.severity)}`,children:e.jsx(I,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.category}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.discoveredDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:xe(s.severity),children:s.severity}),e.jsx(c,{className:me(s.status),children:s.status}),s.cvssScore&&e.jsxs(c,{variant:"outline",children:["CVSS ",s.cvssScore]})]})]},s.id))})})]})]}),e.jsxs(o,{value:"endpoints",className:"space-y-6",children:[e.jsx(a,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx(v,{placeholder:"Search endpoints...",value:se,onChange:e=>ae(e.target.value),className:"max-w-sm"}),e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Import OpenAPI"]}),e.jsxs(n,{size:"sm",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Add Endpoint"]})]})]})})}),e.jsx("div",{className:"grid gap-6",children:ye.map((s,d)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*d},children:e.jsxs(a,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsxs(l,{className:"text-lg flex items-center gap-2",children:[s.name,e.jsx(c,{className:oe(s.method),children:s.method})]}),e.jsx(r,{className:"font-mono text-sm",children:s.url})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-2xl font-bold ${ue(s.riskScore)}`,children:s.riskScore}),e.jsx("p",{className:"text-xs text-gray-600",children:"Risk Score"})]}),s.authRequired&&e.jsx(Z,{className:"h-5 w-5 text-yellow-600",title:"Authentication Required"})]})]})}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Version"}),e.jsx("p",{className:"text-gray-600",children:s.version})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Owner"}),e.jsx("p",{className:"text-gray-600",children:s.owner})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Status"}),e.jsx(c,{className:me("active"===s.status?"passing":"warning"),children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Last Tested"}),e.jsx("p",{className:"text-gray-600",children:new Date(s.lastTested).toLocaleDateString()})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Vulnerabilities"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"p-2 bg-red-50 rounded",children:[e.jsx("p",{className:"text-lg font-bold text-red-600",children:s.vulnerabilities.critical}),e.jsx("p",{className:"text-xs text-gray-600",children:"Critical"})]}),e.jsxs("div",{className:"p-2 bg-orange-50 rounded",children:[e.jsx("p",{className:"text-lg font-bold text-orange-600",children:s.vulnerabilities.high}),e.jsx("p",{className:"text-xs text-gray-600",children:"High"})]}),e.jsxs("div",{className:"p-2 bg-yellow-50 rounded",children:[e.jsx("p",{className:"text-lg font-bold text-yellow-600",children:s.vulnerabilities.medium}),e.jsx("p",{className:"text-xs text-gray-600",children:"Medium"})]}),e.jsxs("div",{className:"p-2 bg-green-50 rounded",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:s.vulnerabilities.low}),e.jsx("p",{className:"text-xs text-gray-600",children:"Low"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Total vulnerabilities: ",Object.values(s.vulnerabilities).reduce((e,s)=>e+s,0)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Details"]}),e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Configure"]}),e.jsxs(n,{size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Test Now"]})]})]})]})})]})},s.id))})]}),e.jsxs(o,{value:"test-suites",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Test Suites"}),e.jsx("p",{className:"text-gray-600",children:"Organized collections of security tests for API endpoints"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Export Results"]}),e.jsxs(n,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Create Suite"]})]})]}),e.jsx("div",{className:"grid gap-6",children:ne.map((s,d)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*d},children:e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"h-6 w-6 text-purple-600"}),e.jsxs("div",{children:[e.jsx(l,{className:"text-lg",children:s.name}),e.jsx(r,{children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:me(s.status),children:s.status}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[s.passRate,"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Pass Rate"})]})]})]})}),e.jsxs(t,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Total Tests"}),e.jsx("p",{className:"text-gray-600",children:s.totalTests})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Endpoints"}),e.jsx("p",{className:"text-gray-600",children:s.endpoints.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Schedule"}),e.jsx("p",{className:"text-gray-600 capitalize",children:s.schedule})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Duration"}),e.jsxs("p",{className:"text-gray-600",children:[s.duration,"m"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Test Coverage"}),e.jsxs("span",{children:[s.passRate,"%"]})]}),e.jsx(f,{value:s.passRate,className:"h-2"})]}),e.jsxs("div",{className:"pt-4 border-t flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Last run: ",new Date(s.lastRun).toLocaleString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"View Tests"]}),e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(n,{size:"sm",onClick:()=>je(s.id),disabled:te,children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Run Suite"]})]})]})]})]})},s.id))})]}),e.jsxs(o,{value:"vulnerabilities",className:"space-y-6",children:[e.jsx(a,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx(v,{placeholder:"Search vulnerabilities...",value:se,onChange:e=>ae(e.target.value),className:"max-w-sm"}),e.jsxs(h,{value:Y,onValueChange:ee,children:[e.jsx(u,{className:"w-[150px]",children:e.jsx(j,{placeholder:"Severity"})}),e.jsxs(p,{children:[e.jsx(g,{value:"all",children:"All Severities"}),e.jsx(g,{value:"critical",children:"Critical"}),e.jsx(g,{value:"high",children:"High"}),e.jsx(g,{value:"medium",children:"Medium"}),e.jsx(g,{value:"low",children:"Low"})]})]})]}),e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})})}),e.jsx("div",{className:"grid gap-6",children:fe.map((s,d)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*d},children:e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${xe(s.severity)}`,children:e.jsx(A,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(l,{className:"text-lg",children:s.title}),e.jsx(r,{children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:xe(s.severity),children:s.severity}),e.jsx(c,{className:me(s.status),children:s.status}),s.cvssScore&&e.jsxs(c,{variant:"outline",children:["CVSS ",s.cvssScore]})]})]})}),e.jsxs(t,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Category"}),e.jsx("p",{className:"text-gray-600",children:s.category})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"OWASP Category"}),e.jsx("p",{className:"text-gray-600",children:s.owaspCategory})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"CWE ID"}),e.jsx("p",{className:"text-gray-600",children:s.cweId||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Discovered"}),e.jsx("p",{className:"text-gray-600",children:new Date(s.discoveredDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Evidence"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded font-mono text-sm",children:s.evidence})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Remediation"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.remediation})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Details"]}),e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),"Copy"]}),"open"===s.status&&e.jsxs(n,{size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Mark Fixed"]})]})]})]})},s.id))})]}),e.jsx(o,{value:"tests",className:"space-y-6",children:e.jsx("div",{className:"grid gap-4",children:re.map((s,i)=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*i},children:e.jsx(a,{children:e.jsxs(t,{className:"pt-6",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex items-center gap-3",children:[he(s.category),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(c,{className:xe(s.severity),children:s.severity}),e.jsx(c,{variant:"outline",children:s.category}),s.automated&&e.jsx(c,{className:"bg-blue-100 text-blue-800",children:"Automated"})]})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Technique"}),e.jsx("p",{className:"text-gray-600",children:s.technique})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"OWASP Category"}),e.jsx("p",{className:"text-gray-600",children:s.owaspCategory})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Expected Result"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.expectedResult})]}),s.payload&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Test Payload"}),e.jsx("div",{className:"bg-gray-50 p-2 rounded font-mono text-xs",children:s.payload})]})]})})]})})},s.id))})}),e.jsxs(o,{value:"scanner",className:"space-y-6",children:[e.jsxs(a,{children:[e.jsxs(i,{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"API Security Scanner"]}),e.jsx(r,{children:"Automated security testing and vulnerability discovery for API endpoints"})]}),e.jsxs(t,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"scan-target",children:"Target API Endpoint"}),e.jsx(v,{id:"scan-target",placeholder:"https://api.example.com/v1/",className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"scan-type",children:"Scan Type"}),e.jsxs(h,{defaultValue:"comprehensive",children:[e.jsx(u,{className:"mt-2",children:e.jsx(j,{})}),e.jsxs(p,{children:[e.jsx(g,{value:"quick",children:"Quick Scan"}),e.jsx(g,{value:"standard",children:"Standard Scan"}),e.jsx(g,{value:"comprehensive",children:"Comprehensive Scan"}),e.jsx(g,{value:"custom",children:"Custom Tests"})]})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"auth-token",children:"Authentication Token (Optional)"}),e.jsx(v,{id:"auth-token",type:"password",placeholder:"Bearer token or API key",className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"scan-config",children:"Additional Configuration"}),e.jsx(y,{id:"scan-config",placeholder:"Custom headers, parameters, or OpenAPI spec URL...",className:"mt-2",rows:4})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Scan Configuration"}),e.jsx("div",{className:"space-y-3",children:["OWASP Top 10 API Security","Authentication & Authorization","Input Validation","Rate Limiting","Data Exposure","Business Logic Flaws"].map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:s}),e.jsx(z,{className:"h-4 w-4 text-green-600"})]},a))})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(n,{size:"lg",onClick:()=>je(),disabled:te,className:"flex items-center gap-2",children:[te?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsx(M,{className:"h-5 w-5"}),te?"Scanning...":"Start Security Scan"]})})]})]}),e.jsxs(a,{children:[e.jsx(i,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Recent Scan History"]})}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:de.slice(0,3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:me(s.status),children:s.status}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.suiteName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.testsRun," tests • ",s.findings," findings"]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.startTime).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-green-600",children:[s.passed," passed"]}),e.jsxs("p",{className:"text-red-600",children:[s.failed," failed"]})]}),e.jsxs(n,{size:"sm",variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"View"]})]})]},s.id))})})]})]})]})]})};export{K as default};
